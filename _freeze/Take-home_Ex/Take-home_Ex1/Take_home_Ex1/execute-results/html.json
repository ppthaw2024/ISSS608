{
  "hash": "ccaed146cdd2e49d2f87b176a09e8abd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take_Home Exercise 1\"\nauthor: \"Pwint Phoo Thaw\"\ndate-modified: \"last-modified\"\nexecute:\n  echo: true\n  eva: true\n  warning: false\n  freeze: true\n---\n\n\n\n# **Ship Performance in the Gulf of Guinea**\n\n## 1. Overview\n\n### Setting the scene\n\nThe maritime sector is one of the most critical components of global trade, contributing significantly to economic growth and sustainability. Understanding ship performance, fuel efficiency, and operational cost factors are essential for improving decision-making and minimizing environmental impact.\n\nAn international media company that publishes weekly content on digital platforms is planning to release articles on \"Ship Performance in the Gulf of Guinea\".\n\nAs the role of the graphical editor of the media company, I am going to prepare data visualization for the article.\n\n### Objective\n\nIn this exercise, Exploratory Data Analysis (EDA) methods and ggplot functions are used to explore:\n\n-   the distribution of Ship performance in **efficiency, operational cost, speed, fuel consumption, and revenue generation**.\n\n-   the relationship between these performances with draft, cargo weight, weather, engine type, ship type, seasonal impact and etc.\n\n## 2. Getting Started\n\n### Loading packages\n\nThe following R packages using the `pacman::p_load()` function are loaded.\n\n-   **tidyverse**: Core collection of R packages designed for data science\n\n-   **haven**: To read in data formats such as SAS and SPSS\n\n-   **ggrepel**: to provides geoms for **ggplot2** to repel overlapping text labels\n\n-   **ggthemes**: to use additional themes for **ggplot2**\n\n-   **patchwork**: to prepare composite figure created using **ggplot2**\n\n-   **ggridges**: to plot ridgeline plots\n\n-   **ggdist**: for visualizations of distributions and uncertainty\n\n-   **scales**: provides the internal scaling infrastructure used by **ggplot2**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, haven,\n               ggrepel, ggthemes,\n               ggridges, ggdist,\n               patchwork, scales)\n```\n:::\n\n\n\n## 3. Data Wrangling\n\n### Importing data\n\nThe dataset used in the exercise is in CSV format, retrieved from `Kaggle.com`<https://www.kaggle.com/datasets/jeleeladekunlefijabi/ship-performance-clustering-dataset>\n\nThe code chunk below import the dataset using `read_csv()` function of the haven package.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr) \nmarine <- read_csv(\"data/Ship_Performance_Dataset.csv\")\n```\n:::\n\n\n\n### Glimpse of data\n\nUsing the `glimpse()` function, we see that the dataset consists of 2,736 rows and 18 columns. It also shows the column names, column type, and the first few entries of each column.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(marine)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,736\nColumns: 18\n$ Date                    <date> 2023-06-04, 2023-06-11, 2023-06-18, 2023-06-2…\n$ Ship_Type               <chr> \"Container Ship\", \"Fish Carrier\", \"Container S…\n$ Route_Type              <chr> \"None\", \"Short-haul\", \"Long-haul\", \"Transocean…\n$ Engine_Type             <chr> \"Heavy Fuel Oil (HFO)\", \"Steam Turbine\", \"Dies…\n$ Maintenance_Status      <chr> \"Critical\", \"Good\", \"Fair\", \"Fair\", \"Fair\", \"F…\n$ Speed_Over_Ground_knots <dbl> 12.59756, 10.38758, 20.74975, 21.05510, 13.742…\n$ Engine_Power_kW         <dbl> 2062.9840, 1796.0574, 1648.5567, 915.2618, 108…\n$ Distance_Traveled_nm    <dbl> 1030.9436, 1060.4864, 658.8741, 1126.8225, 144…\n$ Draft_meters            <dbl> 14.132284, 14.653083, 7.199261, 11.789063, 9.7…\n$ Weather_Condition       <chr> \"Moderate\", \"Rough\", \"Moderate\", \"Moderate\", \"…\n$ Cargo_Weight_tons       <dbl> 1959.0179, 162.3947, 178.0409, 1737.3853, 260.…\n$ Operational_Cost_USD    <dbl> 483832.35, 483388.00, 448543.40, 261349.61, 28…\n$ Revenue_per_Voyage_USD  <dbl> 292183.27, 883765.79, 394018.75, 87551.38, 676…\n$ Turnaround_Time_hours   <dbl> 25.86708, 63.24820, 49.41815, 22.40911, 64.158…\n$ Efficiency_nm_per_kWh   <dbl> 1.4551789, 0.2903614, 0.4995945, 0.7029057, 1.…\n$ Seasonal_Impact_Score   <dbl> 1.4156533, 0.8856478, 1.4058132, 1.3707043, 0.…\n$ Weekly_Voyage_Count     <dbl> 1, 6, 9, 1, 8, 7, 3, 6, 8, 2, 9, 4, 3, 7, 7, 3…\n$ Average_Load_Percentage <dbl> 93.76925, 93.89537, 96.21824, 66.19370, 80.008…\n```\n\n\n:::\n:::\n\n\n\n### Checking for Duplicates\n\nUsing the `duplicated` function, we see that there are no duplicate entries in the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarine[duplicated(marine),]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 0 × 18\n# ℹ 18 variables: Date <date>, Ship_Type <chr>, Route_Type <chr>,\n#   Engine_Type <chr>, Maintenance_Status <chr>, Speed_Over_Ground_knots <dbl>,\n#   Engine_Power_kW <dbl>, Distance_Traveled_nm <dbl>, Draft_meters <dbl>,\n#   Weather_Condition <chr>, Cargo_Weight_tons <dbl>,\n#   Operational_Cost_USD <dbl>, Revenue_per_Voyage_USD <dbl>,\n#   Turnaround_Time_hours <dbl>, Efficiency_nm_per_kWh <dbl>,\n#   Seasonal_Impact_Score <dbl>, Weekly_Voyage_Count <dbl>, …\n```\n\n\n:::\n:::\n\n\n\n### Checking for Missing Values\n\nNumerical Variables are selected to identify\n\nThe `colSums()` function in the **base** package is used to check for missing values in `marine`. There are no missing values in the tibble data frame.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolSums(is.na(marine))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   Date               Ship_Type              Route_Type \n                      0                       0                       0 \n            Engine_Type      Maintenance_Status Speed_Over_Ground_knots \n                      0                       0                       0 \n        Engine_Power_kW    Distance_Traveled_nm            Draft_meters \n                      0                       0                       0 \n      Weather_Condition       Cargo_Weight_tons    Operational_Cost_USD \n                      0                       0                       0 \n Revenue_per_Voyage_USD   Turnaround_Time_hours   Efficiency_nm_per_kWh \n                      0                       0                       0 \n  Seasonal_Impact_Score     Weekly_Voyage_Count Average_Load_Percentage \n                      0                       0                       0 \n```\n\n\n:::\n:::\n\n\n\n### Correlation Analysis\n\nNumerical variables are selected to perform correlation analysis. All the variables looks fine.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(reshape2)\n\n# Select only numeric variables\nnumeric_vars <- marine %>% select(where(is.numeric))\n\n# Compute correlation matrix\ncor_matrix <- cor(numeric_vars, use = \"complete.obs\")\n\n# Melt correlation matrix for better visualization\ncor_data <- melt(cor_matrix)\n\n# Improved heatmap-style correlation matrix\nggplot(data = cor_data, aes(x=Var1, y=Var2, fill=value)) + \n  geom_tile(color = \"white\") + \n  geom_text(aes(label = round(value, 2)), color = \"black\", size = 3) + \n  scale_fill_gradient2(low = \"#E46726\", mid = \"white\", high = \"#6D9EC1\", midpoint = 0) +\n  labs(title = \"Correlation Matrix of Marine Dataset\",\n       x = \"\", y = \"\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n### Filtering for Relevant Variables\n\nOf 18 columns, the following 12 are preliminary selected to answer the analytical questions. The [Code Book](https://www.kaggle.com/datasets/jeleeladekunlefijabi/ship-performance-clustering-dataset/data) from Kaggle provides detailed description of the variables and I have referred to it..\n\n+-------------------------+------------------------------------------------------------------+------------------+\n| Variable Name           | Description                                                      | Type of Variable |\n+=========================+==================================================================+==================+\n| Ship_Type               | Type of ship                                                     | Categorical      |\n|                         |                                                                  |                  |\n|                         | (Fish Carrier, Container Ship, Tanker, Bulk Carrier)             |                  |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Route_Type              | Shipping route type                                              | Categorical      |\n|                         |                                                                  |                  |\n|                         | (Coastal, Short-haul, Long-haul, Transoceanic)                   |                  |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Engine_Type             | Type of engine                                                   | Categorical      |\n|                         |                                                                  |                  |\n|                         | (None, Diesel, Heavy Fuel Oil (HFO), Steam Turbine)              |                  |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Weather_Condition       | Maintenance condition of the ship                                | Categorical      |\n|                         |                                                                  |                  |\n|                         | (None, Calm, Moderate ,Rough)                                    |                  |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Maintenance_Status      | Prevailing weather conditions during voyages                     | Categorical      |\n|                         |                                                                  |                  |\n|                         | (None, Good, Fair, Critical)                                     |                  |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Speed_Over_Ground_knots | Average speed of the ship over water                             | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Engine_Power_kW         | Engine power output                                              | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Distance_Traveled_nm    | Total distance traveled by the ship                              | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Operational_Cost_USD    | Total operational cost per voyage                                | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Revenue_per_Voyage_USD  | Revenue generated per voyage                                     | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Efficiency_nm_per_kWh   | Energy efficiency calculated in nautical miles per kilowatt-hour | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n| Average_Load_Percentage | Average load of the ship calculated in percentage                | Numerical        |\n+-------------------------+------------------------------------------------------------------+------------------+\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmarine_filtered <- marine %>%\n  select(Ship_Type, Route_Type,Engine_Type,Weather_Condition,Maintenance_Status,Speed_Over_Ground_knots,\n        Engine_Power_kW, Distance_Traveled_nm,Operational_Cost_USD,Revenue_per_Voyage_USD,Efficiency_nm_per_kWh,\n        Average_Load_Percentage)\n\nglimpse(marine_filtered)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 2,736\nColumns: 12\n$ Ship_Type               <chr> \"Container Ship\", \"Fish Carrier\", \"Container S…\n$ Route_Type              <chr> \"None\", \"Short-haul\", \"Long-haul\", \"Transocean…\n$ Engine_Type             <chr> \"Heavy Fuel Oil (HFO)\", \"Steam Turbine\", \"Dies…\n$ Weather_Condition       <chr> \"Moderate\", \"Rough\", \"Moderate\", \"Moderate\", \"…\n$ Maintenance_Status      <chr> \"Critical\", \"Good\", \"Fair\", \"Fair\", \"Fair\", \"F…\n$ Speed_Over_Ground_knots <dbl> 12.59756, 10.38758, 20.74975, 21.05510, 13.742…\n$ Engine_Power_kW         <dbl> 2062.9840, 1796.0574, 1648.5567, 915.2618, 108…\n$ Distance_Traveled_nm    <dbl> 1030.9436, 1060.4864, 658.8741, 1126.8225, 144…\n$ Operational_Cost_USD    <dbl> 483832.35, 483388.00, 448543.40, 261349.61, 28…\n$ Revenue_per_Voyage_USD  <dbl> 292183.27, 883765.79, 394018.75, 87551.38, 676…\n$ Efficiency_nm_per_kWh   <dbl> 1.4551789, 0.2903614, 0.4995945, 0.7029057, 1.…\n$ Average_Load_Percentage <dbl> 93.76925, 93.89537, 96.21824, 66.19370, 80.008…\n```\n\n\n:::\n:::\n\n\n\n## 4. Exploratory Data Analysis\n\n### EDA 1: Distribution of Numerical Variables\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(ggridges)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(viridis)\nlibrary(patchwork)\n\n# Convert data to long format for visualization\nmarine_long <- marine %>%\n  pivot_longer(\n    cols = c(\"Speed_Over_Ground_knots\", \"Engine_Power_kW\", \"Distance_Traveled_nm\", \n             \"Operational_Cost_USD\", \"Revenue_per_Voyage_USD\", \"Efficiency_nm_per_kWh\", \n             \"Average_Load_Percentage\"),\n    names_to = \"Variable\",\n    values_to = \"Value\"\n  )\n\n# Apply log transformation for better scaling\nmarine_long <- marine_long %>%\n  mutate(Value = ifelse(Value > 0, log10(Value), NA))  # Log transformation\n\n# Improved Ridge Plot (Better visualization of distributions)\nmarine_ridgeplot <- ggplot(marine_long, aes(x = Value, y = Variable, fill = Variable)) +\n  geom_density_ridges(alpha = 0.7, quantile_lines = TRUE, \n                      quantile_fun = function(y, ...) quantile(y, probs = 0.5, na.rm = TRUE)) +\n  scale_x_continuous(name = \"Log-Transformed Values\", labels = scales::comma) +\n  scale_fill_viridis_d() +\n  labs(title = \"Distributions of Key Numerical Variables in Marine Dataset\") +\n  theme_minimal() +\n  theme(legend.position = \"none\", axis.title.y = element_blank())\n\n# Improved Boxplot (Detecting outliers with better scaling)\nmarine_boxplot <- ggplot(marine_long, aes(x = Variable, y = Value, fill = Variable)) +\n  geom_boxplot(outlier.colour = \"red\", outlier.shape = 16, alpha = 0.8) +\n  coord_flip() +  \n  scale_fill_viridis_d() +\n  labs(title = \"Boxplots of Key Numerical Variables in Marine Dataset\",\n       subtitle = \"Red dots indicate potential outliers\",\n       x = \"\", y = \"Log-Transformed Values\") +\n  theme_minimal() +\n  theme(legend.position = \"none\", axis.title.y = element_blank())\n\n# Combine Ridge Plot and Boxplot\nmarine_ridgeplot / marine_boxplot\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n### EDA 2: Exploring Relationship between Speed and Engine Power\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load necessary libraries\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(patchwork)\n\n# Create the faceted density plot (Speed Over Ground Distribution by Engine Power)\nspeed_densityplot <- ggplot(data = marine, aes(x = Speed_Over_Ground_knots, fill = Engine_Type)) +    \n  geom_density(alpha = 0.3) + \n  facet_wrap(~ Engine_Type, scales = \"free_y\", nrow = 2) +  \n  labs(x = \"Speed Over Ground (knots)\", y = \"Density\", \n       title = \"Speed Distribution Across Engine Types\",\n       subtitle = \"Density plot of Speed Over Ground, colored by Engine Type\") +\n  theme_minimal() +\n  scale_fill_brewer(palette = \"Set1\") +\n  theme(legend.position = \"none\", \n        plot.title = element_text(face = \"bold\", size = 12), \n        plot.subtitle = element_text(size = 8), \n        axis.title.y = element_text(size = 8), \n        axis.title.x = element_text(size = 8))\n\n# Create the boxplot for Speed Over Ground by Engine Type\nspeed_boxplot <- ggplot(marine, aes(x = Engine_Type, y = Speed_Over_Ground_knots, fill = Engine_Type)) +\n  geom_boxplot(position = position_dodge(0.8)) +\n  theme_minimal() +\n  labs(y = \"Speed Over Ground (knots)\", subtitle = \"Box plots of Speed Over Ground by Engine Type\") +\n  theme(axis.title.x = element_blank(), \n        legend.title = element_text(face = \"bold\", size = 8), \n        plot.subtitle = element_text(size = 8), \n        axis.title.y = element_text(size = 8)) +\n  scale_fill_brewer(palette = \"Set2\")\n\n\n\n# Combine the plots\nspeed_densityplot + speed_boxplot\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n### EDA 3: Exploring Relationship between Efficiency Across Ship Type, Engine Type and Route Type\n\n::: panel-tabset\n## Box Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(patchwork)\n# Function to create boxplots\nplot_efficiency_boxplot <- function(var) {\n  ggplot(marine, aes(x = .data[[var]], y = Efficiency_nm_per_kWh, fill = .data[[var]])) +\n    geom_boxplot(outlier.colour = \"red\", outlier.shape = 16, alpha = 0.7) +\n    theme_minimal() +\n    labs(y = \"Efficiency (nm per kWh)\", x = var, \n         subtitle = paste(\"Boxplot of Efficiency across\", var)) +\n    scale_fill_brewer(palette = \"Set2\") +\n    theme(axis.title.x = element_text(face = \"bold\", size = 10),\n          legend.position = \"none\",\n          plot.subtitle = element_text(size = 10),\n          axis.title.y = element_text(size = 10)) +\n    coord_flip()\n}\n\n# Generate boxplots\nboxplot_ship <- plot_efficiency_boxplot(\"Ship_Type\")\nboxplot_engine <- plot_efficiency_boxplot(\"Engine_Type\")\nboxplot_route <- plot_efficiency_boxplot(\"Route_Type\")\n\n# Display all boxplots together\nboxplot_ship / boxplot_engine / boxplot_route\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n## Heatmap\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Convert Efficiency into categories for heatmap visualization\nmarine <- marine %>%\n  mutate(\n    Efficiency_Category = factor(case_when(\n      Efficiency_nm_per_kWh >= quantile(Efficiency_nm_per_kWh, 0.75, na.rm = TRUE) ~ \"High\",\n      Efficiency_nm_per_kWh >= quantile(Efficiency_nm_per_kWh, 0.25, na.rm = TRUE) ~ \"Moderate\",\n      TRUE ~ \"Low\"\n    ), levels = c(\"Low\", \"Moderate\", \"High\"))\n  )\n\n# Calculate proportions across efficiency levels by category\nefficiency_proportions <- marine %>%\n  gather(key = \"Efficiency_Level\", value = \"Value\", Efficiency_Category) %>%\n  count(Ship_Type, Engine_Type, Route_Type, Efficiency_Level, Value) %>%\n  group_by(Ship_Type, Engine_Type, Route_Type, Efficiency_Level) %>%\n  mutate(Proportion = n / sum(n),\n         Value = factor(Value, levels = c(\"Low\", \"Moderate\", \"High\"))) %>%\n  ungroup()\n\n# Function to create heatmaps\nplot_efficiency_heatmap <- function(var) {\n  ggplot(efficiency_proportions, aes(x = .data[[var]], y = Value, fill = Proportion)) +\n    geom_tile() +\n    scale_fill_gradient(low = \"white\", high = \"steelblue\") +\n    facet_wrap(~ Efficiency_Level, scales = \"free_x\") +\n    labs(x = var,\n         y = \"Efficiency Level\",\n         fill = \"Proportion\",\n         subtitle = paste(\"Heatmap of Efficiency variation across\", var)) +\n    theme_minimal() +\n    theme(panel.background = element_rect(fill = \"white\", colour = NA),\n          axis.text.x = element_text(size = 8, angle = 45), \n          axis.text.y = element_text(size = 8),\n          axis.title.x = element_text(size = 8),\n          axis.title.y = element_text(size = 8), \n          legend.text = element_text(size = 8),\n          legend.title = element_text(size = 8),\n          plot.subtitle = element_text(size = 8))\n}\n\n# Generate heatmaps\nefficiency_heatmap_ship <- plot_efficiency_heatmap(\"Ship_Type\")\nefficiency_heatmap_engine <- plot_efficiency_heatmap(\"Engine_Type\")\nefficiency_heatmap_route <- plot_efficiency_heatmap(\"Route_Type\")\n\n# Display all heatmaps together\nefficiency_heatmap_ship + efficiency_heatmap_engine + efficiency_heatmap_route\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n:::\n\n### EDA 4: Exploring Financial Performance\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(ggridges)\nlibrary(patchwork)\n\n# Compute Profitability\nmarine <- marine %>%\n  mutate(Profitability_USD = Revenue_per_Voyage_USD - Operational_Cost_USD)\n\n# Ridgeline Plot of Profitability by Ship Type\nprofitability_ridgeline <- ggplot(marine, aes(x = Profitability_USD, y = Ship_Type, fill = 0.5 - abs(0.5 - stat(ecdf)))) +\n  stat_density_ridges(geom = \"density_ridges_gradient\", calc_ecdf = TRUE) +\n  scale_fill_viridis_c(name = \"Tail probability\", direction = -1) +\n  labs(x = \"Profitability (USD)\", y = \"Ship Type\", \n       title = \"Profitability Distribution by Ship Type\",\n       subtitle = \"Ridgeline plot comparing density distributions\") +\n  theme_minimal() +\n  theme(legend.position = \"none\", \n        plot.title = element_text(face = \"bold\", size = 12), \n        plot.subtitle = element_text(size = 10),\n        axis.title.y = element_text(size = 10), \n        axis.title.x = element_text(size = 10))\n\n# Display Ridgeline Plot\nprint(profitability_ridgeline)\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Scatter Plot Faceted by Ship Type\nprofitability_scatter_facet <- ggplot(marine, aes(x = Operational_Cost_USD, y = Revenue_per_Voyage_USD, color = Ship_Type)) +\n  geom_point(alpha = 0.6, size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE, linetype = \"dashed\", color = \"black\") +\n  theme_minimal() +\n  labs(x = \"Operational Cost (USD)\", y = \"Revenue per Voyage (USD)\", \n       title = \"Relationship Between Operational Cost and Revenue\",\n       subtitle = \"Scatter plot faceted by Ship Type\") +\n  scale_color_brewer(palette = \"Dark2\") +\n  facet_wrap(~ Ship_Type, scales = \"free\") +  # Split plots by Ship Type\n  theme(plot.title = element_text(face = \"bold\", size = 12), \n        plot.subtitle = element_text(size = 10),\n        axis.title.y = element_text(size = 10), \n        axis.title.x = element_text(size = 10),\n        legend.position = \"none\")  # Hides legend since facets already label Ship Type\n\n# Display Faceted Scatter Plot\nprint(profitability_scatter_facet)\n```\n\n::: {.cell-output-display}\n![](Take_home_Ex1_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Take_home_Ex1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}